\section{System Architecture and Design}

%[[ Explain the architecture layering, perhaps include some UML, and mention the
%technologies used.

%Remember a picture is worth a thousand words! ]]

\subsection{Architecture}
We are planning on implementing a Model View Controller (MVC) architecture type for our game. It will be able to handle our in-game logic and how the user interacts with the game itself.
The Model typically will represent the game logic, deck and cards. The View will be responsible for representing the current state of the game to the user. Examples of this are displaying the players stats, profile and friends, having the ability to view output of cards/deck and showing tables in the lobby. We will be using a graphical feature to show this in our project. The Controller will handle user input for various commands like starting the game, ending the game, placing cards, party privacy and updating the players profile settings.

\subsection{Technologies}
Since we are developing a web-based version of the card game ``War", we have decided to use modern web technologies to ensure we have a responsive and scale-able application. Our front end will consist of common technologies used for web development, HTML, CSS, and Javascript. HTML will provide the basic structure of the web page, and CSS will allow us to style the page according to the theme specified by Cosmic Radiance. Javascript will handle game logic on the client side. Our front-end framework will be React.js as this will facilitate with updating the game-state without refreshing the page. React will also help with creating reusable components such as the cards themselves. 

Our back end will need to handle the game logic, player data, and real-time communication. Node.js will allow us to handle game logic outside of the browser. This will allow us the necessary means of handling requests such as determining winners. We will use a library Socket.io to handle real-time communication between multiple clients. 

To store our user data, game history, and player stats we will need persistent storage. We have chosen Firebase as our persistent storage due to its ease of use with real-time updates. It will also allow us to have a more flexible schema as SQL databases require relations among the tables created. Firebase also includes built-in authentication, supporting Google and Facebook sign in, as well as traditional email and password. Overall, Firebase supports our needs of real-time updates, scalability, security, and rapid development. 

\subsection{Persistent Storage}
Our database is composed of three main firebase components, Authentication, Firestore, and Storage. Each of these components is responsible for storing different types of information for each user. The authentication component is responsible for storing user login information, in our application this is the email and password of every user. Importantly, the Authentication component hashes passwords with a built-in function which improves security for our users. The storage component is responsible for storing the profile images of every user. The profile picture uploaded by the user is saved to the storage component under `avatars/user.uid' in which the current user's id is used as the filename. The majority of our user's data will be saved in the Firestore component. The data will be organized as JSON documents which are then organized into collections. The user's information such as, username, friends, stats, and profile picture URL will be saved into a document appropriately titled as the `user.uid'. Each user will require their own document, and all user documents will be stored in the `users' collection. This structure is flexible, making it scale-able which is important for an online multiplayer game. Our NoSQL design ensures that we can continue adding more collections and documents as needed without restructuring the entire database.

\subsection{Coding Standards}
Our database naming scheme will consist of singular, lowercase names for collections (user, leaderboard). Each attribute within documents will use camelCase (userName, gameStats, gameID). Variables and functions in JavaScript should also be written in camelCase. 

We will format our code using two spaces for indentation. Brackets should be used on the same line for functions and other control statements. Inline commenting should be used only to explain complex logic. Multi line comments should be used to describe functions and classes. Additionally, all functions should be properly documented with a multi-line comment describing the purpose, parameters, and return value. 

Testing standards will consist of test-driven development. We will ensure proper functionality by ensuring that all code commits pass necessary code tests before merging. Code tests should handle correctness, edge cases, and performance. 

\subsection{UML Diagram}
\begin{figure}
    \centering
    \includegraphics[width=1\linewidth]{figures/WarUML.png}
    \caption{UML diagram outlining the war card game for Cosmic Radiance}
    \label{fig:enter-label}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=1\linewidth]{figures/Sequence UML .png}
    % cd figures ; ln -s Sequence\ UML\ .png Sequence-UML.png 
    % who puts spaces in file names ;-)
    % \includegraphics[width=1\linewidth]{documentation/figures/sequence-UML.png}
    \caption{UML Sequence diagram for chat of War}
    \label{fig:enter-label}
\end{figure}

The system features a Host class that extends the player class, granting the host control over the table, including decisions on who can join. Additionally, a Game class manages the gameplay mechanics, ensuring that the rules of the game are followed. The User Account class manages all of the information of the User, from their password to avatar, to their friends. Lastly, a table class is made to allow users to join the table or create their own table.

\subsection {UI Mockups}
\begin{figure}
    \centering
    \includegraphics[width=1\linewidth]{figures/Welcome Page UI.png}
    \caption{The UI design for Cosmic Radiance web app's welcome screen features a space-themed layout with royal blue tones.}
    \label{fig:enter-label}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=1\linewidth]{figures/Lobby UI.jpeg}
    \caption{Lobby UI.}
    \label{fig:enter-label}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=1\linewidth]{figures/Login UI.jpeg}
    \caption{Login Screen for Cosmic Radiance War Game.}
    \label{fig:enter-label}
\end{figure}


